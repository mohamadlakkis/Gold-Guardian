# Base image with Python 3.12
FROM python:3.12-slim

# Set the working directory
WORKDIR /app

# Install dependencies for script execution
RUN apt-get update && apt-get install -y \
    bash \
    curl \
    && apt-get clean && rm -rf /var/lib/apt/lists/*

# Copy the project files
COPY . .

# Generate the .env file
RUN echo "OPENAI_API_KEY=your-default-api-key" > .env \
    && echo "SENTIMENT_ANALYSIS_MODEL=ft:gpt-4o-mini-2024-07-18:personal:sentiment-analysis:AaiuCkPu" >> .env \
    && echo "Q_AND_A_MODEL=ft:gpt-4o-mini-2024-07-18:personal:question-answer-v3:AaodkYTJ:ckpt-step-382" >> .env \
    && echo "FLASK_SECRET_KEY=secret" >> .env

# Copy .env to service directories
RUN cp .env LSTM/.env \
    && cp .env Q_and_A/.env \
    && cp .env RAG_service/.env \
    && cp .env sentiment_analysis/.env \
    && cp .env UI/.env

# Default command for the master service
CMD ["bash"]
